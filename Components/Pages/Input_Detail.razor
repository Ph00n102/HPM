@page "/input_detail"
@using HPM.Service
@using HPM.Models
@using HPM.Data.Entities
@inject NavigationManager NavigationManager
@inject JobRequestService JobRequestService
@attribute [StreamRendering]
@rendermode InteractiveServer


<style>
    .grid{
        @* margin-bottom: 3rem; *@
        @* display: grid; *@
        grid-template-columns: repeat(auto-fit,minmax(200px, 1fr)); @*1fr คือให้คำนวณพื้นที่ auto*@
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    select {
      background-color: #fffccb;
    }
    .btn1 {
        width: 90px;
        height: 35px;
        background: #aeaeae;
        border: none;
        outline: none;
        border-radius: 20px; @*ทำให้มุมมน*@
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);
        cursor: pointer;
        color: #000000;
        font-weight: 600;
        background-image: linear-gradient(180deg, #6efda7 0%, #028938 70%);
    }
    .btn2 {
        width: 90px;
        height: 35px;
        background: #aeaeae;
        border: none;
        outline: none;
        border-radius: 20px; @*ทำให้มุมมน*@
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);
        cursor: pointer;
        color: #000000;
        font-weight: 600;
        background-image: linear-gradient(180deg, #bb9ffd 0%, #6123de 70%);
    }
</style>

 @*<div class="row grid">
    <div class="col-lg-4 offset-lg-4 pt-4 pb-4">
        <div class="mb-3">
            <label >วันที่</label>
              <input type="datetime-local" id="birthdaytime" name="birthdaytime">
        </div> 
        
    </div>
</div>*@
<br />
<br />
<div class="container grid ">
  <div class="row ">
    <div class="col-sm-4">
       <label>HN/QN :</label>
        @* <input type="text" class="form-control" style="background-color: #fdfce0;"> *@
        <InputText class="form-control" @bind-Value="jobRequest.HN" style="background-color: #fdfce0;"/>
    </div>
    </div>
    <div class="col-sm-4">
       <label>ชื่อ-นามสกุล :</label>
        @* <input type="text" class="form-control" @bind-Value="jobRequest.PatientType" style="background-color: #fdfce0;"> *@
        <InputText class="form-control" @bind-Value="jobRequest.FirstName" style="background-color: #fdfce0;"/>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-4">
      <label>ประเภทคนไข้ :</label>
        <select class="form-select" @bind="jobRequest.PatientType" aria-label="Default select example" style="background-color: #fdfce0;">
            <option selected>เลือกประเภทคนไข้</option>
            <option value="1">OPD</option>
            <option value="2">IPD</option>
        </select>
    </div>
    <div class="col-sm-4">
       <label>ประเภทรถเข็น :</label>
         <select class="form-select" @bind="jobRequest.MaterialName" aria-label="Default select example" style="background-color: #fdfce0;">
            <option selected>เลือกประเภทรถเข็น</option>
            <option value="1">รถนั่ง</option>
            <option value="2">รถนอน</option>
            <option value="3">เฉพาะคน(มีรถแล้ว)</option>
            <option value="4">รถนั่งปรับนอน</option>
            <option value="5">รถนั่งปรับนอน + ออกซิเจน</option>
            <option value="6">รถนั่ง + เสาน้ำเกลือ</option>
            <option value="7">รถนั่ง + ออกซิเจน</option>
            <option value="8">รถนอน + ออกซิเจน</option>
            <option value="9">รถนอนผู้ป่วยติดเชื้อ</option>
            <option value="10">รถนั่งผู้ป่วยติดเชื้อ</option>
            <option value="11">รถนอนผู้ป่วยติดเชื้อ + ออกซิเจน</option>
            <option value="12">รถนั่งผู้ป่วยติดเชื้อ + ออกซิเจน</option>
            <option value="13">รถนอนพร้อมเปลตัก</option>
            <option value="14">รถนอนพร้อมบอร์ด</option>
            <option value="15">รถ Ambulance</option>
        </select>
    </div>
  </div>
   <div class="row">
      <div class="col-sm-4">
       <label>ประเภทความเร่งด่วน :</label>
        <select class="form-select" @bind="jobRequest.UrgentType" aria-label="Default select example" style="background-color: #fdfce0;">
            <option selected>เลือกประเภทความเร่งด่วน</option>
            <option value="1">ปกติ</option>
            <option value="2">ด่วน</option>
            <option value="3">ฉุกเฉิน</option>
        </select>
    </div>
  </div>
  <br />
  <br />
   <div class="row">
      <div class="col-sm-8">
          <label>หมายเหตุ :</label>
        <textarea class="form-control" @bind="jobRequest.Remark" id="exampleFormControlTextarea1" rows="3" style="background-color: #fdfce0;"></textarea>
      </div>
      <div class="col">
      </div>
  </div>
  <br />
  
  <div class="row">
    <div class="col-sm-4">
       <label>จุดส่งที่ 1 :</label>
       <select class="form-select" @bind="jobRequest.Destination" aria-label="Default select example" style="background-color: #fdfce0;">
            <option selected>เลือกจุดส่ง</option>
            <option value="1">1 ห้องฉุกเฉิน (ER)</option>
            <option value="2">2 ห้องเจาะเลือด</option>
            <option value="3">3 แผนกเอ็กซเรย์</option>
            <option value="4">4 ห้องตรวจคลื่นหัวใจ (EKG)</option>
        </select>
    </div>
    <div class="col-sm-4">
      <label>จุดส่งที่ 2 :</label>
       <select class="form-select" @bind="jobRequest.Destination" aria-label="Default select example" style="background-color: #fdfce0;">
            <option selected>เลือกจุดส่ง</option>
            <option value="1">1 ห้องฉุกเฉิน (ER)</option>
            <option value="2">2 ห้องเจาะเลือด</option>
            <option value="3">3 แผนกเอ็กซเรย์</option>
            <option value="4">4 ห้องตรวจคลื่นหัวใจ (EKG)</option>
        </select>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-4">
       <label>จุดส่งที่ 3 :</label>
       <select class="form-select" @bind="jobRequest.Destination" aria-label="Default select example" style="background-color: #fdfce0;">
            <option selected>เลือกจุดส่ง</option>
            <option value="1">1 ห้องฉุกเฉิน (ER)</option>
            <option value="2">2 ห้องเจาะเลือด</option>
            <option value="3">3 แผนกเอ็กซเรย์</option>
            <option value="4">4 ห้องตรวจคลื่นหัวใจ (EKG)</option>
        </select>
    </div>
    <div class="col-sm-4">
      <label>จุดส่งที่ 4 :</label>
       <select class="form-select" @bind="jobRequest.Destination" aria-label="Default select example" style="background-color: #fdfce0;">
            <option selected>เลือกจุดส่ง</option>
            <option value="1">1 ห้องฉุกเฉิน (ER)</option>
            <option value="2">2 ห้องเจาะเลือด</option>
            <option value="3">3 แผนกเอ็กซเรย์</option>
            <option value="4">4 ห้องตรวจคลื่นหัวใจ (EKG)</option>
        </select>
    </div>
  </div>
  
 
  <br />
  <div class="row">
    <div class="col-sm-4" align="right" style="width:120px;">
      <button class="btn1 btn-success" @onclick="SaveAsync">บันทึก</button>
    </div>
    @* <div class="col-sm-4" style="width:120px;">
      <button  @onclick="btn_click_add" class="btn2 btn-success" >เพิ่มข้อมูล</button>
    </div> *@
  </div>



@code 
{ 
    @* public JobRequest? jobRequest { get; set; } *@
    @* [Parameter]
    public EventCallback<MethodResult> OnSaveJob{ get; set; } *@
    
    @* Data.Entities.JobRequest jobRequest = new(); *@
    [Parameter]
    public int JobId { get; set; } 
    private JobRequest jobRequest = new();
    private string message = string.Empty;
    private string Title = "Add Job";
    
    private void SaveAsync()
    {
        
        if (JobRequestService.AddUpdate(jobRequest))
        {
            message = "Sucessfully added";
            jobRequest = new();
        }
        else
        {
            message = "Could not saved";
        }
    } 
     private void btn_click_add() 
    { 
        NavigationManager.NavigateTo("/index_nurse"); 
    }  

    @* private async Task SaveAsync()

    {
         MethodResult result = await JobRequestService.SaveAsync(jobRequest);
        if (result.Status)
        {
            jobRequest = new();
            NavigationManager.NavigateTo("/index_nurse");
        }
        await OnSaveJob.InvokeAsync(result);
    } *@
}
